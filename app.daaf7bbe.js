var e=globalThis,t={},n={},a=e.parcelRequire94c2;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in n){var a=n[e];delete n[e];var o={id:e,exports:{}};return t[e]=o,a.call(o.exports,o,o.exports),o.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){n[e]=t},e.parcelRequire94c2=a),a.register;var o=a("6AR8M"),l=a("cOa8X"),r=(a("ilpIi"),a("ilpIi")),l=a("cOa8X");async function d(e,t,n,a,o){if(!l.auth.currentUser)return null;try{return(await (0,r.addDoc)((0,r.collection)(l.db,`users/${l.auth.currentUser.uid}/books`),{name:e,author:t,genres:n,rating:a,url:o||null,status:"Reading"})).id}catch{return null}}async function u(e){if(!l.auth.currentUser)return null;await (0,r.deleteDoc)((0,r.doc)(l.db,`users/${l.auth.currentUser.uid}/books`,e))}async function c(e,t){return!!l.auth.currentUser&&(await (0,r.updateDoc)((0,r.doc)(l.db,`users/${l.auth.currentUser.uid}/books`,e),{status:t}),!0)}const i=["Reading","Completed","Want to Read","Dropped"],s=document.getElementById("p_user");document.getElementById("btn_logout").addEventListener("click",()=>(0,o.signOut)(l.auth));const m=document.getElementById("form_addbook"),p=document.getElementById("text_bookname"),h=document.getElementById("text_bookauthor"),g=document.getElementById("select_genres"),f=document.getElementById("div_rating"),y=document.getElementById("range_rating"),E=document.getElementById("text_url"),C=document.getElementById("div_bookcontainer");function v(e){for(let t of(console.log(e),C.innerHTML="",e)){console.log(t);let e=document.createElement("div");e.className="box flex row gap-md";{let n=document.createElement("div");n.className="flex column gap-sm";let a=document.createElement("p");a.textContent=t.name,n.appendChild(a);let o=document.createElement("p");o.textContent=t.author,n.appendChild(o);let l=document.createElement("p");l.textContent=t.genres.join(", "),n.appendChild(l),e.appendChild(n)}{let n=document.createElement("div");n.className="flex column gap-sm";let a=document.createElement("div");if(a.className="rating_display",b(a,t.rating),n.appendChild(a),t.url){let e=document.createElement("a");e.textContent=e.href=t.url,n.appendChild(e)}e.appendChild(n)}{let n=document.createElement("div");n.className="flex column gap-md";let a=document.createElement("select");for(let e of i){let n=document.createElement("option");n.selected=e===t.status,n.label=e,n.value=e,a.appendChild(n)}a.addEventListener("change",e=>c(t.id,e.target.value)),n.appendChild(a);let o=document.createElement("button");o.textContent="Delete Book",o.addEventListener("click",async()=>{confirm(`Are you sure you want to delete "${t.name}"?`)&&u(t.id)}),n.appendChild(o),e.appendChild(n)}C.appendChild(e)}}function b(e,t){let n=Math.min(5,Math.max(0,t));e.innerHTML="";for(let t=0;t<5;t++){let a=document.createElement("p");a.textContent=t<n?"★":"☆",e.appendChild(a)}}(0,l.auth).onAuthStateChanged(e=>{e?(s.textContent=`Logged in as ${e.displayName}`,function(e){if(!l.auth.currentUser)throw"No authenticated user";(0,r.onSnapshot)((0,r.collection)(l.db,`users/${l.auth.currentUser.uid}/books`),t=>e(t.docs.map(e=>({id:e.id,...e.data()}))))}(v),(0,r.getDoc)((0,r.doc)(l.db,"static","genres")).then(e=>{let t=e.get("genres");for(let e of(console.log(t),t)){let t=document.createElement("option");t.value=e,t.label=e,g.appendChild(t)}}).catch(e=>console.log(e))):window.location="undefined/"}),b(f,parseInt(y.value)),y.addEventListener("input",function(){b(f,parseInt(this.value))}),m.addEventListener("submit",function(e){e.preventDefault(),p.setCustomValidity(""),h.setCustomValidity(""),g.setCustomValidity("");let t={},n=p.value.trim();0===n.length&&(t.text_bookname=["empty"]);let a=h.value.trim();0===a.length&&(t.text_bookauthor=["empty"]);let o=[...g.selectedOptions].map(e=>e.value);0===o.length&&(t.select_genres=["empty"]);let l=parseInt(y.value),r=E.value.trim();if(0!==Object.keys(t).length){t.text_bookname&&p.setCustomValidity("Name cannot be empty"),t.text_bookauthor&&h.setCustomValidity("Author cannot be empty"),t.select_genres&&g.setCustomValidity("Must select at least one genre");return}d(n,a,o,l,r).then(()=>m.reset()).catch()});
//# sourceMappingURL=app.daaf7bbe.js.map
