{"mappings":"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","sources":["<anon>","src/js/app.js","src/js/api.js"],"sourcesContent":["\n      var $parcel$global = globalThis;\n    \nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire94c2\"];\n\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire94c2\"] = parcelRequire;\n}\n\nvar parcelRegister = parcelRequire.register;\n\nvar $6AR8M = parcelRequire(\"6AR8M\");\n\nvar $cOa8X = parcelRequire(\"cOa8X\");\n\nvar $ilpIi = parcelRequire(\"ilpIi\");\n\nvar $ilpIi = parcelRequire(\"ilpIi\");\n\nvar $cOa8X = parcelRequire(\"cOa8X\");\nasync function $db1f432b457e32b4$export$8ccccb4c3330f6b(name, author, genres, rating, url) {\n    if (!(0, $cOa8X.auth).currentUser) return null;\n    try {\n        const result = await (0, $ilpIi.addDoc)((0, $ilpIi.collection)((0, $cOa8X.db), `users/${(0, $cOa8X.auth).currentUser.uid}/books`), {\n            name: name,\n            author: author,\n            genres: genres,\n            rating: rating,\n            url: url ? url : null,\n            status: \"Reading\"\n        });\n        return result.id;\n    } catch  {\n        return null;\n    }\n}\nasync function $db1f432b457e32b4$export$e67978e040affc73(id) {\n    if (!(0, $cOa8X.auth).currentUser) return null;\n    await (0, $ilpIi.deleteDoc)((0, $ilpIi.doc)((0, $cOa8X.db), `users/${(0, $cOa8X.auth).currentUser.uid}/books`, id));\n}\nasync function $db1f432b457e32b4$export$4c7d1278a60f36b1() {\n    if (!(0, $cOa8X.auth).currentUser) return [];\n    const snapshot = await (0, $ilpIi.getDocs)((0, $ilpIi.collection)((0, $cOa8X.db), `users/${(0, $cOa8X.auth).currentUser.uid}/books`));\n    return $db1f432b457e32b4$var$formatCollectionData(snapshot);\n}\nasync function $db1f432b457e32b4$export$52ce59462f283493(genre) {\n    if (!(0, $cOa8X.auth).currentUser) return [];\n    const snapshot = await (0, $ilpIi.getDocs)((0, $ilpIi.query)((0, $ilpIi.collection)((0, $cOa8X.db), `users/${(0, $cOa8X.auth).currentUser.uid}/books`), (0, $ilpIi.where)(\"genre\", \"array-contains\", genre)));\n    return $db1f432b457e32b4$var$formatCollectionData(snapshot);\n}\nasync function $db1f432b457e32b4$export$d522a9fb73a5dc47(id, status) {\n    if (!(0, $cOa8X.auth).currentUser) return false;\n    await (0, $ilpIi.updateDoc)((0, $ilpIi.doc)((0, $cOa8X.db), `users/${(0, $cOa8X.auth).currentUser.uid}/books`, id), {\n        status: status\n    });\n    return true;\n}\nfunction $db1f432b457e32b4$export$d6a44dc5d7393c51(fn) {\n    if (!(0, $cOa8X.auth).currentUser) throw 'No authenticated user';\n    (0, $ilpIi.onSnapshot)((0, $ilpIi.collection)((0, $cOa8X.db), `users/${(0, $cOa8X.auth).currentUser.uid}/books`), (snapshot)=>fn($db1f432b457e32b4$var$formatCollectionData(snapshot)));\n}\nfunction $db1f432b457e32b4$var$formatCollectionData(snapshot) {\n    return snapshot.docs.map((doc)=>({\n            id: doc.id,\n            ...doc.data()\n        }));\n}\n\n\nconst $388b617130f03bd4$var$statuses = [\n    \"Reading\",\n    \"Completed\",\n    \"Want to Read\",\n    \"Dropped\"\n];\nconst $388b617130f03bd4$var$p_user = document.getElementById('p_user');\nconst $388b617130f03bd4$var$btn_logout = document.getElementById('btn_logout');\n$388b617130f03bd4$var$btn_logout.addEventListener('click', ()=>(0, $6AR8M.signOut)((0, $cOa8X.auth)));\nconst $388b617130f03bd4$var$form_addbook = document.getElementById('form_addbook');\nconst $388b617130f03bd4$var$text_bookname = document.getElementById('text_bookname');\nconst $388b617130f03bd4$var$text_bookauthor = document.getElementById('text_bookauthor');\nconst $388b617130f03bd4$var$select_genres = document.getElementById('select_genres');\nconst $388b617130f03bd4$var$div_rating = document.getElementById('div_rating');\nconst $388b617130f03bd4$var$range_rating = document.getElementById('range_rating');\nconst $388b617130f03bd4$var$text_url = document.getElementById('text_url');\nconst $388b617130f03bd4$var$div_bookcontainer = document.getElementById('div_bookcontainer');\n(0, $cOa8X.auth).onAuthStateChanged((user)=>{\n    if (!user) // eslint-disable-next-line no-undef\n    window.location = `${undefined}/`;\n    else {\n        $388b617130f03bd4$var$p_user.textContent = `Logged in as ${user.displayName}`;\n        (0, $db1f432b457e32b4$export$d6a44dc5d7393c51)($388b617130f03bd4$var$renderBooks);\n        (0, $ilpIi.getDoc)((0, $ilpIi.doc)((0, $cOa8X.db), 'static', 'genres')).then((snapshot)=>{\n            const genres = snapshot.get('genres');\n            console.log(genres);\n            for (let genre of genres){\n                const option = document.createElement('option');\n                option.value = genre;\n                option.label = genre;\n                $388b617130f03bd4$var$select_genres.appendChild(option);\n            }\n        }).catch((err)=>console.log(err));\n    }\n});\n$388b617130f03bd4$var$formatRating($388b617130f03bd4$var$div_rating, parseInt($388b617130f03bd4$var$range_rating.value));\n$388b617130f03bd4$var$range_rating.addEventListener('input', function() {\n    $388b617130f03bd4$var$formatRating($388b617130f03bd4$var$div_rating, parseInt(this.value));\n});\n$388b617130f03bd4$var$form_addbook.addEventListener('submit', function(event) {\n    event.preventDefault();\n    $388b617130f03bd4$var$text_bookname.setCustomValidity('');\n    $388b617130f03bd4$var$text_bookauthor.setCustomValidity('');\n    $388b617130f03bd4$var$select_genres.setCustomValidity('');\n    const errors = {};\n    const name = $388b617130f03bd4$var$text_bookname.value.trim();\n    if (name.length === 0) errors.text_bookname = [\n        'empty'\n    ];\n    const author = $388b617130f03bd4$var$text_bookauthor.value.trim();\n    if (author.length === 0) errors.text_bookauthor = [\n        'empty'\n    ];\n    // Converts the HTMLCollection to a normal array\n    const genres = [\n        ...$388b617130f03bd4$var$select_genres.selectedOptions\n    ].map((option)=>option.value);\n    if (genres.length === 0) errors.select_genres = [\n        'empty'\n    ];\n    const rating = parseInt($388b617130f03bd4$var$range_rating.value);\n    const url = $388b617130f03bd4$var$text_url.value.trim();\n    if (Object.keys(errors).length !== 0) {\n        if (errors.text_bookname) $388b617130f03bd4$var$text_bookname.setCustomValidity('Name cannot be empty');\n        if (errors.text_bookauthor) $388b617130f03bd4$var$text_bookauthor.setCustomValidity('Author cannot be empty');\n        if (errors.select_genres) $388b617130f03bd4$var$select_genres.setCustomValidity('Must select at least one genre');\n        return;\n    }\n    (0, $db1f432b457e32b4$export$8ccccb4c3330f6b)(name, author, genres, rating, url).then(()=>$388b617130f03bd4$var$form_addbook.reset()).catch();\n});\nfunction $388b617130f03bd4$var$renderBooks(books) {\n    console.log(books);\n    $388b617130f03bd4$var$div_bookcontainer.innerHTML = \"\";\n    // I wish I had JSX or something right about now\n    for (let book of books){\n        console.log(book);\n        const bookContainer = document.createElement('div');\n        bookContainer.className = 'box flex row gap-md';\n        {\n            const container = document.createElement('div');\n            container.className = \"flex column gap-sm\";\n            const bookName = document.createElement('p');\n            bookName.textContent = book.name;\n            container.appendChild(bookName);\n            const bookAuthor = document.createElement('p');\n            bookAuthor.textContent = book.author;\n            container.appendChild(bookAuthor);\n            const bookGenres = document.createElement('p');\n            bookGenres.textContent = book.genres.join(', ');\n            container.appendChild(bookGenres);\n            bookContainer.appendChild(container);\n        }\n        {\n            const container = document.createElement('div');\n            container.className = \"flex column gap-sm\";\n            const bookRating = document.createElement('div');\n            bookRating.className = 'rating_display';\n            $388b617130f03bd4$var$formatRating(bookRating, book.rating);\n            container.appendChild(bookRating);\n            if (book.url) {\n                const bookURL = document.createElement('a');\n                bookURL.textContent = bookURL.href = book.url;\n                container.appendChild(bookURL);\n            }\n            bookContainer.appendChild(container);\n        }\n        {\n            const container = document.createElement('div');\n            container.className = \"flex column gap-md\";\n            const statusSelect = document.createElement('select');\n            for (let status of $388b617130f03bd4$var$statuses){\n                const option = document.createElement('option');\n                option.selected = status === book.status;\n                option.label = status;\n                option.value = status;\n                statusSelect.appendChild(option);\n            }\n            statusSelect.addEventListener('change', (event)=>(0, $db1f432b457e32b4$export$d522a9fb73a5dc47)(book.id, event.target.value));\n            container.appendChild(statusSelect);\n            const removeBookButton = document.createElement('button');\n            removeBookButton.textContent = \"Delete Book\";\n            removeBookButton.addEventListener('click', async ()=>{\n                const result = confirm(`Are you sure you want to delete \"${book.name}\"?`);\n                if (result) (0, $db1f432b457e32b4$export$e67978e040affc73)(book.id);\n            });\n            container.appendChild(removeBookButton);\n            bookContainer.appendChild(container);\n        }\n        $388b617130f03bd4$var$div_bookcontainer.appendChild(bookContainer);\n    }\n}\nfunction $388b617130f03bd4$var$formatRating(element, rating) {\n    const parsedRating = Math.min(5, Math.max(0, rating));\n    element.innerHTML = \"\";\n    for(let i = 0; i < 5; i++){\n        const p = document.createElement('p');\n        p.textContent = i < parsedRating ? \"\\u2605\" : \"\\u2606\";\n        element.appendChild(p);\n    }\n// return \"★\".repeat(parsedRating)+\"☆\".repeat(5-parsedRating)\n}\n\n\n//# sourceMappingURL=app.daaf7bbe.js.map\n","import { signOut } from \"firebase/auth\"\nimport { auth, db } from \"./firebase\"\nimport {  doc, getDoc } from \"firebase/firestore\"\nimport { addBook, addBookChangeListener, removeBook, setBookStatus } from \"./api\"\n\nconst statuses = [\n    \"Reading\",\n    \"Completed\",\n    \"Want to Read\",\n    \"Dropped\"\n]\n\nconst p_user = document.getElementById('p_user')\nconst btn_logout = document.getElementById('btn_logout')\nbtn_logout.addEventListener('click', () => signOut(auth))\n\nconst form_addbook = document.getElementById('form_addbook')\nconst text_bookname = document.getElementById('text_bookname')\nconst text_bookauthor = document.getElementById('text_bookauthor')\nconst select_genres = document.getElementById('select_genres')\nconst div_rating = document.getElementById('div_rating')\nconst range_rating = document.getElementById('range_rating')\nconst text_url = document.getElementById('text_url')\n\nconst div_bookcontainer = document.getElementById('div_bookcontainer')\n\nauth.onAuthStateChanged(user => {\n    if (!user)\n        // eslint-disable-next-line no-undef\n        window.location = process.env.NODE_ENV === \"production\"?`${process.env.SUB_DOMAIN}/`:'/'\n    else {\n        p_user.textContent = `Logged in as ${user.displayName}`\n        addBookChangeListener(renderBooks)\n        getDoc(doc(db, 'static', 'genres'))\n            .then(snapshot => {\n                const genres = snapshot.get('genres')\n                console.log(genres)\n                for (let genre of genres) {\n                    const option = document.createElement('option')\n                    option.value = genre\n                    option.label = genre\n                    select_genres.appendChild(option)\n                }\n            })\n            .catch(err => console.log(err))\n    }\n})\n\nformatRating(div_rating, parseInt(range_rating.value))\nrange_rating.addEventListener('input', function () {\n    formatRating(div_rating, parseInt(this.value))\n})\nform_addbook.addEventListener('submit', function (event) {\n    event.preventDefault()\n    text_bookname.setCustomValidity('')\n    text_bookauthor.setCustomValidity('')\n    select_genres.setCustomValidity('')\n    const errors = {}\n    const name = text_bookname.value.trim()\n    if (name.length === 0) {\n        errors.text_bookname = ['empty']\n    }\n    const author = text_bookauthor.value.trim()\n    if (author.length === 0) {\n        errors.text_bookauthor = ['empty']\n    }\n    // Converts the HTMLCollection to a normal array\n    const genres = [...select_genres.selectedOptions].map(option => option.value)\n    if (genres.length === 0) {\n        errors.select_genres = ['empty']\n    }\n    const rating = parseInt(range_rating.value)\n    const url = text_url.value.trim()\n\n    if (Object.keys(errors).length !== 0) {\n        if (errors.text_bookname)\n            text_bookname.setCustomValidity('Name cannot be empty')\n        if (errors.text_bookauthor)\n            text_bookauthor.setCustomValidity('Author cannot be empty')\n        if (errors.select_genres)\n            select_genres.setCustomValidity('Must select at least one genre')\n        return\n    }\n\n    addBook(name, author, genres, rating, url)\n        .then(() => form_addbook.reset())\n        .catch()\n});\n\nfunction renderBooks(books) {\n    console.log(books)\n    div_bookcontainer.innerHTML = \"\"\n    // I wish I had JSX or something right about now\n    for (let book of books) {\n        console.log(book)\n        const bookContainer = document.createElement('div')\n        bookContainer.className = 'box flex row gap-md'\n\n        {\n            const container = document.createElement('div')\n            container.className = \"flex column gap-sm\"\n\n            const bookName = document.createElement('p')\n            bookName.textContent = book.name\n            container.appendChild(bookName)\n\n            const bookAuthor = document.createElement('p')\n            bookAuthor.textContent = book.author\n            container.appendChild(bookAuthor)\n\n            const bookGenres = document.createElement('p')\n            bookGenres.textContent = book.genres.join(', ')\n            container.appendChild(bookGenres)\n\n            bookContainer.appendChild(container)\n        }\n        {\n            const container = document.createElement('div')\n            container.className = \"flex column gap-sm\"\n\n            const bookRating = document.createElement('div')\n            bookRating.className = 'rating_display'\n            formatRating(bookRating, book.rating)\n            container.appendChild(bookRating)\n\n            if (book.url) {\n                const bookURL = document.createElement('a')\n                bookURL.textContent = bookURL.href = book.url\n                container.appendChild(bookURL)\n            }\n\n            bookContainer.appendChild(container)\n        }\n        {\n            const container = document.createElement('div')\n            container.className = \"flex column gap-md\"\n\n            const statusSelect = document.createElement('select')\n            for (let status of statuses) {\n                const option = document.createElement('option')\n                option.selected = status === book.status\n                option.label = status\n                option.value = status\n                statusSelect.appendChild(option)\n            }\n            statusSelect.addEventListener('change', event => setBookStatus(book.id, event.target.value))\n            container.appendChild(statusSelect)\n\n\n            const removeBookButton = document.createElement('button')\n            removeBookButton.textContent = \"Delete Book\"\n            removeBookButton.addEventListener('click', async () => {\n                const result = confirm(`Are you sure you want to delete \"${book.name}\"?`)\n                if (result)\n                    removeBook(book.id)\n            })\n            container.appendChild(removeBookButton)\n\n            bookContainer.appendChild(container)\n        }\n\n        div_bookcontainer.appendChild(bookContainer)\n    }\n}\n\nfunction formatRating(element, rating) {\n    const parsedRating = Math.min(5, Math.max(0, rating))\n    element.innerHTML = \"\"\n    for (let i = 0; i < 5; i++) {\n        const p = document.createElement('p')\n        p.textContent = i < parsedRating ? \"★\" : \"☆\"\n        element.appendChild(p)\n    }\n    // return \"★\".repeat(parsedRating)+\"☆\".repeat(5-parsedRating)\n}","import { addDoc, collection, deleteDoc, doc, getDocs, onSnapshot, query, updateDoc, where } from \"firebase/firestore\";\nimport { auth, db } from \"./firebase\";\n\nexport async function addBook(name, author, genres, rating, url) {\n    if (!auth.currentUser) return null\n    try {\n        const result = await addDoc(collection(db, `users/${auth.currentUser.uid}/books`), {\n            name,\n            author,\n            genres,\n            rating,\n            url: url ? url : null,\n            status: \"Reading\"\n        })\n        return result.id\n    } catch {\n        return null\n    }\n}\nexport async function removeBook(id) {\n    if (!auth.currentUser) return null\n    await deleteDoc(doc(db, `users/${auth.currentUser.uid}/books`, id))\n}\nexport async function getBooks() {\n    if (!auth.currentUser) return []\n    const snapshot = await getDocs(collection(db, `users/${auth.currentUser.uid}/books`))\n    return formatCollectionData(snapshot)\n}\nexport async function getBooksByGenre(genre) {\n    if (!auth.currentUser) return []\n    const snapshot = await getDocs(query(\n        collection(db, `users/${auth.currentUser.uid}/books`),\n        where(\"genre\", \"array-contains\", genre)\n    ))\n    return formatCollectionData(snapshot)\n}\nexport async function setBookStatus(id, status) {\n    if (!auth.currentUser) return false\n    await updateDoc(doc(db, `users/${auth.currentUser.uid}/books`, id), {\n        status: status\n    })\n    return true\n}\nexport function addBookChangeListener(fn) {\n    if (!auth.currentUser) throw 'No authenticated user'\n    onSnapshot(collection(db, `users/${auth.currentUser.uid}/books`), snapshot => fn(formatCollectionData(snapshot)))\n}\nfunction formatCollectionData(snapshot) {\n    return snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n    }))\n}"],"names":["$parcel$global","globalThis","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$6AR8M","$cOa8X","$ilpIi","$db1f432b457e32b4$export$8ccccb4c3330f6b","name","author","genres","rating","url","auth","currentUser","result","addDoc","collection","db","uid","status","$db1f432b457e32b4$export$e67978e040affc73","deleteDoc","doc","$db1f432b457e32b4$export$d522a9fb73a5dc47","updateDoc","$388b617130f03bd4$var$statuses","$388b617130f03bd4$var$p_user","document","getElementById","$388b617130f03bd4$var$btn_logout","addEventListener","signOut","$388b617130f03bd4$var$form_addbook","$388b617130f03bd4$var$text_bookname","$388b617130f03bd4$var$text_bookauthor","$388b617130f03bd4$var$select_genres","$388b617130f03bd4$var$div_rating","$388b617130f03bd4$var$range_rating","$388b617130f03bd4$var$text_url","$388b617130f03bd4$var$div_bookcontainer","$388b617130f03bd4$var$renderBooks","books","book","console","log","innerHTML","bookContainer","createElement","className","container","bookName","textContent","appendChild","bookAuthor","bookGenres","join","bookRating","$388b617130f03bd4$var$formatRating","bookURL","href","statusSelect","option","selected","label","value","event","target","removeBookButton","confirm","element","parsedRating","Math","min","max","i","p","onAuthStateChanged","user","displayName","fn","onSnapshot","snapshot","docs","map","data","getDoc","then","get","genre","catch","window","location","parseInt","preventDefault","setCustomValidity","errors","trim","length","text_bookname","text_bookauthor","selectedOptions","select_genres","Object","keys","reset"],"version":3,"file":"app.daaf7bbe.js.map"}